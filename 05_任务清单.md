# 项目任务清单与进度跟踪 (Idea Capsule)

---

**欢迎来到你的项目作战指挥室！**

这份文档是你的"想法胶囊"项目的核心任务清单。你将在这里跟踪从环境配置到最终上线的每一个步骤。完成一项，就在复选框中打上一个 `x` (`- [x]`)。

每次只完成一个 [ ]，我确认后才开始下一项。

---

## 阶段〇：环境准备与项目初始化 (macOS 专属)

**目标：** 在你的电脑上搭建起一套完整的、专业的前端开发环境，并创建好项目的基本骨架。

### 0.1: 安装核心开发工具

*   [x] **安装 Homebrew (macOS的包管理器):** 打开你的"终端(Terminal)"应用，复制并粘贴以下命令，然后按回车。
    ```bash
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    ```
*   [x] **安装 Git (版本控制工具):** 在终端中运行以下命令。
    ```bash
    brew install git
    ```
*   [x] **安装 NVM (Node.js 版本管理器):** 强烈推荐使用 NVM，它可以让你轻松切换 Node.js 版本。
    ```bash
    brew install nvm
    ```
*   [x] **配置 NVM:**
    1. 创建NVM的工作目录: `mkdir ~/.nvm`
    2. 将NVM配置写入你的Shell配置文件 `~/.zshrc` 中 (macOS Catalina及之后版本默认为zsh):
    ```bash
    echo 'export NVM_DIR="$HOME/.nvm"' >> ~/.zshrc
    echo '[ -s "/opt/homebrew/opt/nvm/nvm.sh" ] && \. "/opt/homebrew/opt/nvm/nvm.sh"' >> ~/.zshrc
    echo '[ -s "/opt/homebrew/opt/nvm/bash_completion" ] && \. "/opt/homebrew/opt/nvm/bash_completion"' >> ~/.zshrc
    ```
    3. **重启终端**或运行 `source ~/.zshrc` 使配置生效。
*   [x] **安装 Node.js (LTS长期支持版):** 使用 NVM 安装 Node.js。
    ```bash
    nvm install --lts
    ```
*   [x] **安装 MongoDB Compass (数据库图形界面):** 让你能直观地看到数据库里的数据。
    ```bash
    brew install --cask mongodb-compass
    ```
*   [x] **验证安装:** 在终端中分别运行以下命令，如果都显示了版本号，说明工具已安装成功。
    ```bash
    git --version
    node -v
    npm -v
    ```

### 0.2: 创建项目骨架

*   [x] **创建项目根目录:** 在你喜欢的位置（例如"桌面"）创建一个文件夹并进入。
    ```bash
    cd ~/Desktop
    mkdir idea-capsule
    cd idea-capsule
    ```
*   [x] **初始化 Git 仓库:** 让 Git 开始管理你的项目。
    ```bash
    git init
    ```
*   [x] **创建全局 `.gitignore` 文件:** 这个文件告诉 Git 哪些文件或文件夹不需要被追踪。
    *   创建一个名为 `.gitignore` 的文件，并填入以下内容：
    ```
    # 依赖 & 构建产物
    node_modules
    dist
    build
    
    # 环境变量文件 (非常重要！)
    .env
    .env.local
    
    # 系统 & IDE
    .DS_Store
    .idea
    .vscode
    ```
*   [ ] **提交第一个版本:** 这是你项目的"创世纪"提交。
    ```bash
    git add .
    git commit -m "Initial: Setup project repository and .gitignore"
    ```

### 0.3: 初始化后端项目 (Server)

*   [ ] **创建并进入后端目录:**
    ```bash
    mkdir server
    cd server
    ```
*   [ ] **初始化 Node.js 项目:** 这会创建一个 `package.json` 文件，用于管理后端依赖。
    ```bash
    npm init -y
    ```
*   [ ] **安装后端核心依赖:**
    *   `express`: Web服务器框架。
    *   `mongoose`: 连接 MongoDB 的"翻译官"。
    *   `cors`: 解决跨域问题。
    *   `dotenv`: 管理环境变量。
    ```bash
    npm install express mongoose cors dotenv
    ```
*   [ ] **返回根目录并提交代码:**
    ```bash
    cd ..
    git add .
    git commit -m "Feat(server): Initialize backend project with dependencies"
    ```

### 0.4: 初始化前端项目 (Client)

*   [ ] **使用官方脚手架创建 React 应用:** 这个命令会自动创建一个名为 `client` 的文件夹，并包含一个完整的 React 项目。
    ```bash
    npx create-react-app client
    ```
*   [ ] **提交前端初始化代码:**
    ```bash
    git add .
    git commit -m "Feat(client): Initialize frontend project with Create React App"
    ```
---

## 下一步行动

你已经完成了所有基础准备工作！你的项目现在拥有了清晰的文件夹结构，并且前后端都已正确初始化。

**接下来，我们将进入【阶段一：后端开发】。**

请在确认以上步骤没有问题后告诉我，我将为你生成下一阶段详细的、精确到每个API的开发任务清单。

---

## 阶段一：后端开发 (Server-Side)

**目标：** 构建一个稳定、可靠的API服务器，它能够连接数据库，并提供"创建"和"读取"想法胶囊的核心功能。

### 1.1: 搭建后端服务基础

*   [ ] **创建后端目录结构:** 在 `server` 文件夹内，创建清晰的目录结构。
    ```bash
    cd server
    mkdir models routes controllers
    touch server.js .env
    ```
*   [ ] **配置环境变量:** 在 `server/.env` 文件中，定义你的数据库连接字符串。
    ```
    # 数据库连接URI (请将<database_name>替换为你想要的名字，例如 idea-capsule-db)
    MONGODB_URI=mongodb://localhost:27017/<database_name>
    
    # 服务器端口
    PORT=5000
    ```
*   [ ] **创建数据库连接模块:** 在 `server` 目录下创建一个 `db.js` 文件，专门负责连接数据库。
    *   *代码目标：使用 `mongoose` 和 `dotenv` 连接到 MongoDB。*
*   [ ] **创建主服务文件 `server.js`:**
    *   *代码目标：导入 `express`, `cors` 和数据库连接模块。配置 `express.json()` 中间件。让服务器监听在 `PORT` 端口。*
*   [ ] **添加启动脚本:** 在 `server/package.json` 的 `scripts` 部分，添加一个 `dev` 脚本，以便使用 `nodemon` 自动重启服务（可选，但强烈推荐）。
    *   先安装 `nodemon`: `npm install -D nodemon`
    *   添加脚本: `"dev": "nodemon server.js"`

### 1.2: 实现 "想法胶囊" (Capsule) 核心API

*   [ ] **定义数据模型 (Model):** 在 `server/models/capsuleModel.js` 中，根据我们的数据字典创建 Mongoose Schema。
    *   *代码目标：定义 `content` 和 `createdAt` 字段，包括它们的类型、是否必需以及默认值。*
*   [ ] **创建路由 (Routes):** 在 `server/routes/capsuleRoutes.js` 中定义 API 路由。
    *   *代码目标：定义 `GET /` 和 `POST /` 两个路由，并指向对应的控制器函数。*
*   [ ] **编写控制器 (Controllers):** 在 `server/controllers/capsuleController.js` 中编写核心业务逻辑。
    *   [ ] **实现 `createCapsule` 函数:**
        *   从请求体 `req.body` 中获取 `content`。
        *   进行输入验证，确保 `content` 不为空。
        *   创建一个新的 `Capsule` 模型实例并保存到数据库。
        *   返回 `201` 状态码和新创建的数据。
        *   使用 `try...catch` 捕获并处理潜在错误。
    *   [ ] **实现 `getCapsules` 函数:**
        *   从数据库中查找所有的 `capsules`。
        *   使用 `.sort({ createdAt: -1 })` 进行降序排序。
        *   返回 `200` 状态码和数据列表。
        *   使用 `try...catch` 捕获并处理潜在错误。
*   [ ] **集成路由到 `server.js`:** 在 `server.js` 中，导入并使用 `capsuleRoutes`。
*   [ ] **手动API测试:** 使用 `curl` 或 Postman/MongoDB Compass 等工具，测试 `POST /api/capsules` 和 `GET /api/capsules` 接口是否按预期工作。
*   [ ] **提交后端代码:**
    ```bash
    git add .
    git commit -m "Feat(api): Implement GET and POST endpoints for capsules"
    ```

---

## 阶段二：前端开发 (Client-Side)

**目标：** 构建一个美观、易用的React用户界面，让用户可以与我们开发的后端API进行交互。

### 2.1: 前端项目准备

*   [ ] **进入前端目录:**
    ```bash
    cd client
    ```
*   [ ] **清理样板代码:** 删除 `src/` 目录下 `App.test.js`, `logo.svg`, `reportWebVitals.js`, `setupTests.js` 等不需要的文件，并清理 `App.js` 和 `index.js` 中的相关导入。
*   [ ] **安装 `axios`:** 一个流行的、用于发送HTTP请求的库。
    ```bash
    npm install axios
    ```
*   [ ] **配置前端环境变量:** 在 `client` 目录下创建 `.env` 文件，并定义后端API的地址。
    ```
    # React应用必须以 REACT_APP_ 开头
    REACT_APP_API_URL=http://localhost:5000/api/capsules
    ```

### 2.2: 开发核心UI组件

*   [ ] **创建组件目录结构:** 在 `client/src/` 目录下创建 `components` 文件夹。
*   [ ] **开发 `CapsuleForm.js` 组件:**
    *   *代码目标：创建一个包含 `input` 和 `button` 的表单。使用 `useState` 管理输入框的内容。在表单提交时，调用一个函数将新想法发送到后端。*
*   [ ] **开发 `CapsuleList.js` 组件:**
    *   *代码目标：接收一个名为 `capsules` 的 props (数组)。遍历这个数组，为每条想法渲染一个 `CapsuleItem` 组件。*
*   [ ] **开发 `CapsuleItem.js` 组件:**
    *   *代码目标：接收单个 `capsule` 对象作为 prop。展示其 `content` 和格式化后的 `createdAt` 日期。*
*   [ ] **创建API服务模块:** 在 `client/src/` 下创建 `api.js` 文件，集中管理所有与后端通信的函数。
    *   *代码目标：导出 `fetchCapsules` 和 `createCapsule` 两个异步函数，它们内部使用 `axios` 来调用环境变量中定义的API地址。*

### 2.3: 组装并驱动应用

*   [ ] **重构 `App.js`:**
    *   *代码目标：作为应用的顶层容器。*
    *   使用 `useState` 创建 `capsules` 状态来存储想法列表。
    *   使用 `useEffect` 在组件首次加载时调用 `api.fetchCapsules()`，并将返回结果设置到 `capsules` 状态中。
    *   定义一个 `addCapsule` 函数，它会调用 `api.createCapsule()`，成功后再调用 `fetchCapsules()` 来刷新列表。
    *   将 `addCapsule` 函数传递给 `CapsuleForm`，将 `capsules` 状态传递给 `CapsuleList`。
*   [ ] **添加基础样式:** 在 `App.css` 或 `index.css` 中添加一些CSS，让应用看起来更美观。
*   [ ] **提交前端代码:**
    ```bash
    git add .
    git commit -m "Feat(client): Implement UI for creating and displaying capsules"
    ```

---

## 阶段三：部署与收尾

**目标：** 将你的本地项目发布到互联网，让全世界的人都能访问你的作品。

*   [ ] **创建 GitHub 仓库:** 在 GitHub.com 上创建一个新的空仓库。
*   [ ] **关联本地与远程仓库:** 按照 GitHub 提供的指令，将你的本地 `idea-capsule` 项目推送到远程仓库。
*   [ ] **准备后端进行部署:**
    *   修改 `server.js`，让 `MONGODB_URI` 和 `PORT` 完全从 `process.env` 读取，为Render等平台的部署做准备。
*   [ ] **部署后端到 Render:**
    *   注册并登录 Render.com。
    *   创建一个新的 "Web Service"，并关联到你的 GitHub 仓库。
    *   设置启动命令为 `npm start` (需要你在 `package.json` 中配置 `"start": "node server.js"`)。
    *   在 Render 的 "Environment" 设置中，添加 `MONGODB_URI` 环境变量（**注意：此时应使用 MongoDB Atlas 等云数据库的生产环境URI，而非`localhost`**）。
*   [ ] **准备前端进行部署:**
    *   确保你的 `api.js` 文件中的请求地址使用的是 `REACT_APP_API_URL` 环境变量。
*   [ ] **部署前端到 Vercel:**
    *   注册并登录 Vercel.com。
    *   创建一个新项目，并关联到你的 GitHub 仓库。
    *   Vercel 会自动识别出是 Create React App 项目并进行正确配置。
    *   在 Vercel 的 "Environment Variables" 设置中，将 `REACT_APP_API_URL` 的值设置为你刚刚部署好的后端服务的公开网址 (例如 `https://idea-capsule-server.onrender.com/api/capsules`)。
*   [ ] **最终测试:** 访问你的Vercel网址，完整测试一遍所有功能。
*   [ ] **最终提交:**
    ```bash
    git commit -m "Deploy: Launch Idea Capsule v1.0 to production"
    ```

---

**恭喜！你已经完成了从一个想法到全栈应用开发与部署的全过程！** 